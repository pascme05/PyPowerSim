#######################################################################################################################
#######################################################################################################################
# Title:        PWM Distortion Toolkit for Standard Topologies
# Topic:        Power Electronics
# File:         genWave
# Date:         14.08.2023
# Author:       Dr. Pascal A. Schirmer
# Version:      V.0.2
# Copyright:    Pascal Schirmer
#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
# Import libs
#######################################################################################################################
# ==============================================================================
# Internal
# ==============================================================================

# ==============================================================================
# External
# ==============================================================================
import numpy as np
from scipy import signal


#######################################################################################################################
# Function
#######################################################################################################################
def genWave(t, fel, phi, phi2, setupTopo):
    ###################################################################################################################
    # Initialisation
    ###################################################################################################################
    Nsim = len(t)

    ###################################################################################################################
    # Calculation
    ###################################################################################################################
    # ==============================================================================
    # Sinusoidal
    # ==============================================================================
    if setupTopo['wave'] == "sin":
        wave = np.sin(2 * np.pi * fel * t + phi + phi2)
        print("INFO: Sinusoidal waveform generated")

    # ==============================================================================
    # Constant
    # ==============================================================================
    elif setupTopo['wave'] == "con":
        wave = np.ones((Nsim,))
        print("INFO: Constant waveform generated")

    # ==============================================================================
    # Triangular
    # ==============================================================================
    elif setupTopo['wave'] == "tri":
        wave = signal.sawtooth(2 * np.pi * fel * t + phi + phi2, 0.5)
        print("INFO: Triangular waveform generated")

    # ==============================================================================
    # Rectangular
    # ==============================================================================
    elif setupTopo['wave'] == "rec":
        wave = signal.square(2 * np.pi * fel * t + phi + phi2, 0.5)
        print("INFO: Rectangular waveform generated")

    # ==============================================================================
    # Default
    # ==============================================================================
    else:
        wave = np.sin(2 * np.pi * fel * t + phi + phi2)
        print("ERROR: Undefined waveform using sinusoidal wave")

    ###################################################################################################################
    # Output
    ###################################################################################################################
    return wave
