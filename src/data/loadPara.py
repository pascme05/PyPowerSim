#######################################################################################################################
#######################################################################################################################
# Title:        PWM Distortion Toolkit for Standard Topologies
# Topic:        Power Electronics
# File:         loadPara
# Date:         27.04.2024
# Author:       Dr. Pascal A. Schirmer
# Version:      V.1.0
# Copyright:    Pascal Schirmer
#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
# Function Description
#######################################################################################################################
"""
This function loads the parameters for the switching devices and the capacitor under \cpar. This includes experimental,
data, topology, and electrical as well as thermal parameter information. The parameters are summarized in one common
dataPara variable.
Inputs:     1) setup:   includes all simulation variables
            2) path:    includes all path variables
Outputs:    1) setup:   extended setup variable
"""

#######################################################################################################################
# Import libs
#######################################################################################################################
# ==============================================================================
# Internal
# ==============================================================================
from src.data.loadParaSwi import loadParaSwi
from src.data.loadParaCap import loadParaCap

# ==============================================================================
# External
# ==============================================================================


#######################################################################################################################
# Function
#######################################################################################################################
def loadPara(setup, path):
    ###################################################################################################################
    # MSG IN
    ###################################################################################################################
    print("------------------------------------------")
    print("START: Loading Parameter")
    print("------------------------------------------")

    ###################################################################################################################
    # Initialisation
    ###################################################################################################################
    dataPara = {'Swi': {}, 'Cap': {}}

    ###################################################################################################################
    # Loading
    ###################################################################################################################
    # ==============================================================================
    # Switches
    # ==============================================================================
    # Inverter Topologies
    paraSwi = loadParaSwi(setup['Exp']['Swi'], path['parPath'], setup)

    # DCDC Topologies
    if setup['Top']['sourceType'] == 'DAB':
        pri_name = setup['Exp'].get('SwiPri', setup['Exp']['Swi'])
        sec_name = setup['Exp'].get('SwiSec', setup['Exp']['Swi'])
        paraSwiPri = loadParaSwi(pri_name, path['parPath'], setup)
        paraSwiSec = loadParaSwi(sec_name, path['parPath'], setup)
    else:
        paraSwiPri = paraSwi
        paraSwiSec = paraSwi

    # ==============================================================================
    # Capacitor
    # ==============================================================================
    paraCap = loadParaCap(setup['Exp']['Cap'], path['parPath'], setup)

    ###################################################################################################################
    # Post-Processing
    ###################################################################################################################
    dataPara['Swi'] = paraSwi
    dataPara['SwiPri'] = paraSwiPri
    dataPara['SwiSec'] = paraSwiSec
    dataPara['Cap'] = paraCap

    ###################################################################################################################
    # MSG Out
    ###################################################################################################################
    print("------------------------------------------")
    print("END: Loading Parameter")
    print("------------------------------------------")

    return dataPara
