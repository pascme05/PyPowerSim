#######################################################################################################################
#######################################################################################################################
# Title:        PWM Distortion Toolkit for Standard Topologies
# Topic:        Power Electronics
# File:         loadPara
# Date:         27.04.2024
# Author:       Dr. Pascal A. Schirmer
# Version:      V.1.0
# Copyright:    Pascal Schirmer
#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
# Function Description
#######################################################################################################################
"""
This function loads the parameters for the switching devices and the capacitor under \cpar. This includes experimental,
data, topology, and electrical as well as thermal parameter information. The parameters are summarized in one common
dataPara variable.
Inputs:     1) setup:   includes all simulation variables
            2) path:    includes all path variables
Outputs:    1) setup:   extended setup variable
"""

#######################################################################################################################
# Import libs
#######################################################################################################################
# ==============================================================================
# Internal
# ==============================================================================
from src.data.loadParaSwi import loadParaSwi
from src.data.loadParaCap import loadParaCap
from src.data.loadParaTra import loadParaTra

# ==============================================================================
# External
# ==============================================================================


#######################################################################################################################
# Function
#######################################################################################################################
def loadPara(setup, path):
    ###################################################################################################################
    # MSG IN
    ###################################################################################################################
    print("------------------------------------------")
    print("START: Loading Parameter")
    print("------------------------------------------")

    ###################################################################################################################
    # Initialisation
    ###################################################################################################################
    dataPara = {'Swi': {}, 'Cap': {}, 'Tra': {}}

    ###################################################################################################################
    # Loading
    ###################################################################################################################
    # ==============================================================================
    # Switches
    # ==============================================================================
    paraSwi = loadParaSwi(setup['Exp']['Swi'], path['parPath'], setup)

    # ==============================================================================
    # Capacitor
    # ==============================================================================
    paraCap = loadParaCap(setup['Exp']['Cap'], path['parPath'], setup)

    # ==============================================================================
    # Transformer
    # ==============================================================================
    paraTra = loadParaTra(setup['Exp']['Tra'], path['parPath'], setup)

    ###################################################################################################################
    # Post-Processing
    ###################################################################################################################
    dataPara['Swi'] = paraSwi
    dataPara['Cap'] = paraCap
    dataPara['Tra'] = paraTra

    ###################################################################################################################
    # MSG Out
    ###################################################################################################################
    print("------------------------------------------")
    print("END: Loading Parameter")
    print("------------------------------------------")

    return dataPara
