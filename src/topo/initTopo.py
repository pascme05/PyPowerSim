#######################################################################################################################
#######################################################################################################################
# Title:        PWM Distortion Toolkit for Standard Topologies
# Topic:        Power Electronics
# File:         initTopo
# Date:         27.04.2024
# Author:       Dr. Pascal A. Schirmer
# Version:      V.1.0
# Copyright:    Pascal Schirmer
#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
# Function Description
#######################################################################################################################
"""
This function initialises the respective topology under evaluation
Inputs:     1) name:    name of the topology
            2) setup:   includes all setup variables
Outputs:    1) top:     topology class
"""

#######################################################################################################################
# Import libs
#######################################################################################################################
# ==============================================================================
# Internal
# ==============================================================================
from src.topo.classB2 import classB2
from src.topo.classB4 import classB4
from src.topo.classB6 import classB6

# ==============================================================================
# External
# ==============================================================================

#######################################################################################################################
# Additional Functions
#######################################################################################################################


#######################################################################################################################
# Main Function
#######################################################################################################################
def initTopo(name, setup):
    ###################################################################################################################
    # MSG IN
    ###################################################################################################################
    print("INFO: Init topology class")

    ###################################################################################################################
    # Initialisation
    ###################################################################################################################
    if name == "B2":
        top = classB2(setup['Top']['fel'], setup['Par']['PWM']['fs'], setup['Exp']['fsim'],
                      setup['Par']['PWM']['td'], setup['Par']['PWM']['tmin'], setup['Dat']['stat']['cyc'],
                      setup['Dat']['stat']['W'], setup['Dat']['stat']['Mi'], setup['Dat']['stat']['Vdc'],
                      setup['Dat']['stat']['Tc'], setup['Dat']['stat']['Tj'], setup['Dat']['trans']['Tc'],
                      setup['Dat']['trans']['Tj'])
    elif name == "B4":
        top = classB4(setup['Top']['fel'], setup['Par']['PWM']['fs'], setup['Exp']['fsim'],
                      setup['Par']['PWM']['td'], setup['Par']['PWM']['tmin'], setup['Dat']['stat']['cyc'],
                      setup['Dat']['stat']['W'], setup['Dat']['stat']['Mi'], setup['Dat']['stat']['Vdc'],
                      setup['Dat']['stat']['Tc'], setup['Dat']['stat']['Tj'], setup['Dat']['trans']['Tc'],
                      setup['Dat']['trans']['Tj'])
    elif name == "B6":
        top = classB6(setup['Top']['fel'], setup['Par']['PWM']['fs'], setup['Exp']['fsim'],
                      setup['Par']['PWM']['td'], setup['Par']['PWM']['tmin'], setup['Dat']['stat']['cyc'],
                      setup['Dat']['stat']['W'], setup['Dat']['stat']['Mi'], setup['Dat']['stat']['Vdc'],
                      setup['Dat']['stat']['Tc'], setup['Dat']['stat']['Tj'], setup['Dat']['trans']['Tc'],
                      setup['Dat']['trans']['Tj'])
    else:
        top = []
        print("ERROR: Invalid topology class")

    ###################################################################################################################
    # Return
    ###################################################################################################################
    return top

#######################################################################################################################
# References
#######################################################################################################################
