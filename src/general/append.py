#######################################################################################################################
#######################################################################################################################
# Title:        PWM Distortion Toolkit for Standard Topologies
# Topic:        Power Electronics
# File:         append
# Date:         01.14.2023
# Author:       Dr. Pascal A. Schirmer
# Version:      V.0.1
# Copyright:    Pascal Schirmer
#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
# Import libs
#######################################################################################################################
# ==============================================================================
# Internal
# ==============================================================================

# ==============================================================================
# External
# ==============================================================================
import pandas as pd

#######################################################################################################################
# Function
#######################################################################################################################
def app_fs(data, elec, loss, setupExp):
    ###################################################################################################################
    # Calculation
    ###################################################################################################################
    # ==============================================================================
    # Switching Period
    # ==============================================================================
    if setupExp['freqPar'] == 'fs':
        # ------------------------------------------
        # Electrical
        # ------------------------------------------
        for c1 in data['elec']:
            for c2 in data['elec'][c1]:      
                data['elec'][c1][c2] = pd.concat([data['elec'][c1][c2], elec[c1][c2]])

        # ------------------------------------------
        # Losses
        # ------------------------------------------
        for c1 in data['loss']:
            for c2 in data['loss'][c1]:      
                data['loss'][c1][c2] = pd.concat([data['loss'][c1][c2], loss[c1][c2]])

    # ==============================================================================
    # Electrical Period
    # ==============================================================================
    else:
        # ------------------------------------------
        # Electrical
        # ------------------------------------------
        for c1 in data['elec']:
            for c2 in data['elec'][c1]:      
                data['elec'][c1][c2] = elec[c1][c2]

        # ------------------------------------------
        # Losses
        # ------------------------------------------
        for c1 in data['loss']:
            for c2 in data['loss'][c1]:      
                data['loss'][c1][c2] = loss[c1][c2]

    ###################################################################################################################
    # Return
    ###################################################################################################################
    return data


#######################################################################################################################
# Function
#######################################################################################################################
def app_fel(data, elec, loss, Nel, setupExp):
    ###################################################################################################################
    # Calculation
    ###################################################################################################################
    # ==============================================================================
    # Switching Period
    # ==============================================================================
    if setupExp['loop'] == 'OL':
        for j in range(0, Nel):
            # ------------------------------------------
            # Electrical
            # ------------------------------------------
            for c1 in data['elec']:
                for c2 in data['elec'][c1]:      
                    data['elec'][c1][c2] = pd.concat([data['elec'][c1][c2], elec[c1][c2]])

            # ------------------------------------------
            # Losses
            # ------------------------------------------
            for c1 in data['loss']:
                for c2 in data['loss'][c1]:      
                    data['loss'][c1][c2] = pd.concat([data['loss'][c1][c2], loss[c1][c2]])

    # ==============================================================================
    # Electrical Period
    # ==============================================================================
    else:
        # ------------------------------------------
        # Electrical
        # ------------------------------------------
        for c1 in data['elec']:
            for c2 in data['elec'][c1]:      
                data['elec'][c1][c2] = pd.concat([data['elec'][c1][c2], elec[c1][c2]])

        # ------------------------------------------
        # Losses
        # ------------------------------------------
        for c1 in data['loss']:
            for c2 in data['loss'][c1]:      
                data['loss'][c1][c2] = pd.concat([data['loss'][c1][c2], loss[c1][c2]])

    ###################################################################################################################
    # Return
    ###################################################################################################################
    return data